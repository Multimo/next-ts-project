{"version":3,"file":"5.b202de574703ab88f13d.hot-update.js","sources":["webpack:///src/models/store.ts"],"sourcesContent":["import { types, applySnapshot, flow, getSnapshot } from 'mobx-state-tree';\n\n// isomophic fetch since fetch only works only exists on the window\nimport fetch from 'node-fetch';\n\nlet store = null\n\nexport const getAlbums = async () => {\n  try {\n    const res = await fetch('https://jsonplaceholder.typicode.com/albums');\n    const albums = await res.json();\n    return albums;\n  } catch (e) {\n    console.log(e);\n  }\n}\n\nexport const getPosts = async () => {\n  try {\n    const res = await fetch('https://jsonplaceholder.typicode.com/posts');\n    const posts = await res.json();\n    return posts;\n  } catch (e) {\n    console.log(e);\n  }\n}\n\nconst Album = types.model('Album' ,{\n  id: types.number,\n  userId: types.number,\n  title: types.string,\n})\n\nconst Post = types.model('Post' ,{\n  id: types.number,\n  userId: types.number,\n  title: types.string,\n})\n\nexport const albumStore = types\n  .model('store', {\n    albums: types.optional(types.array(Album), []),\n    posts: types.optional(types.array(Post), []),\n    toggle: types.optional(types.boolean, false),\n  })\n  .actions((self) => ({\n    toggler() {\n      self.toggle = !self.toggle;\n    },\n  }));\n    // const fetchAlbums = flow(function* () {\n    //   const res = yield getAlbums();\n    //   console.log('FETCHED!!!!!!!!!!!!!!!!!')\n    //   applySnapshot(self.albums, res)\n    // });\n\n    // return ({\n    //   // afterCreate() {\n    //   //   fetchAlbums()\n    //   // },\n    //   fetchAlbums,\n      \n    // });\n  // });\n\nexport const alStore = albumStore.create();\n\n// export const rehydrateStore = async (isServer: boolean, snapshot = null) => {\n//   if (isServer || alStore.albums.length === 0) {\n//     const hellomyoldfirend = await getAlbums();\n//     const posts = await getPosts();\n//     console.log()\n//     store = albumStore.create({\n//       albums: hellomyoldfirend || [],\n//       posts: posts || [],\n//     });\n//     return { \n//       initialState: getSnapshot(store), \n//       isServer, \n//     };\n//   }\n  \n\n//   // if (snapshot) {\n//   //   console.log('is store alive?', alStore, snapshot)\n//   //   return store\n//   // }\n//     // store = applySnapshot(alStore, snapshot)\n\n//   return alStore;\n// };\n\nexport const rehydrateStore = (initialState) => {\n  initialState && applySnapshot(alStore, initialState);\n  return alStore;\n}\n\nexport const initStore = async () => {\n  if (alStore.albums.length && alStore.posts.length) {\n    const hellomyoldfirend = await getAlbums();\n    const posts = await getPosts();\n    console.log()\n    store = albumStore.create({\n      albums: hellomyoldfirend || [],\n      posts: posts || [],\n    });\n    return { \n      initialState: getSnapshot(store), \n    };\n  }\n\n  return \n};\n\n\n\n\n// WEBPACK FOOTER //\n// src/models/store.ts"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AAFA;AAAA;AACA;AADA;AAGA;AAHA;AACA;AADA;AAAA;AAAA;AAMA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AAFA;AAAA;AACA;AADA;AAGA;AAHA;AACA;AADA;AAAA;AAAA;AAMA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAUA;AACA;AACA;AACA;AAHA;AAMA;AACA;AACA;AACA;AAHA;AAMA;AAEA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AAHA;AAAA;AAMA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAEA;AAFA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AAFA;AALA;AAUA;AADA;AACA;AAVA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;;;;A","sourceRoot":""}